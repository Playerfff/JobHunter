# C++程序性能优化

## 架构

[软件设计杂谈——性能优化的十种手段（上篇） · Joey's Tech Notes & Blogs (code2life.top)](https://code2life.top/2020/08/15/0055-performance/)

1. **性能优化通常是“时间”与“空间”的互换与取舍**。
   1. **索引术**
      1. Hash Table
      2. Binary Search Tree
      3. B-Tree
      4. B+Tree
      5. Trie Tree
      6. Skip List
      7. Inverted index
   2. **缓存**
      1. 传统意义上的缓存
      2. 对象重用的池化技术
   3. **压缩**
      1. **对数据的压缩虽然消耗了时间来换取更小的空间存储，但更小的存储空间会在另一个维度带来更大的时间收益**。
      2. 对无用信息删减;
   4. **预存**
      1. 当可以猜测出以后的某个时间很有可能会用到某种数据时，把数据预先取到需要用的地方，能大幅度提升用户体验或服务端响应速度。
      2. 预存副作用: 后面不一定需要, 浪费资源;
   5. **削峰填谷术**
      1. 短期抗住大量需求, 事后花时间做;
      2. 对于客户端的**启动优化**: 代码/数据的延时加载、后台异步加载、按需懒加载；
      3. 对于正常的业务请求洪峰， 用消息队列暂存再异步化处理；
      4. 从入口处削峰；
   6. **批量处理**
      1. 大量耗时操作积累到一次， 一次性传输；
      2. 批量处理的**副作用**在于：处理逻辑会更加复杂，尤其是一些涉及事务、并发的问题；需要用数组或队列用来存放缓冲一批数据，消耗了额外的存储空间。
2. **榨干计算资源**
   1. **focus on CPU**: less copy, less context switch, less system call
   2. 使用更高效的数据结构、算法、第三方组件
   3. 提升硬件的短板（木桶原则）
3. **水平扩容**
   1. 水平扩容必然带来负载均衡
4. **分片数**
5. **去锁**